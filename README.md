# AI-Knowledge-Agent

> **"帮你自动维护 Notion 知识库的 Python 智能助手"**

这是一个让你**“只管收藏，不管整理”**的自动化工具。你只需要把 GitHub 仓库或技术文章的链接丢进 Notion，剩下的脏活累活全交给它。

它主要解决三个痛点：
1.  **懒得填内容**：你只填 URL，它自动爬取网页内容并转成 Markdown 填入 Notion。
2.  **链接总失效**：收藏的库改名或删了？它会自动全网搜索新的有效地址并帮你修好（**死链自愈**）。
3.  **怕数据丢失**：每天自动把 Notion 数据全量备份到本地，生成 JSON/Markdown，甚至生成一个**“一键复活脚本”**，随时能重建数据库。

即使你半年不看，你的知识库也依然是鲜活的，而不是一堆 404 死链。

## 🧠 为什么做这个？

*   **Notion 就是我的数据库**：我不喜欢本地存一堆文件，Notion 是唯一的数据源。
*   **机器人打工**：我只负责丢链接，剩下的抓取、检查、备份，全是机器人后台自己跑。
*   **本地只是个备份**：Agent 每天会自动把 Notion 数据打包成 JSON/Markdown 文件。如果你用 Docker 部署，这些文件会自动保存到你服务器的 `backups/` 目录下（已配置挂载），确保云端数据在本地也有一份物理拷贝。

---

## ✨ 它能干什么？

### 1. 🔄 自动填内容
你在 Notion 里新建一个页面，填上 URL (比如 GitHub 仓库地址)，然后... 就可以不管了。
程序会每隔一段时间（默认 24 小时）扫一遍，发现没内容的，就自动把网页内容抓下来填进去。

### 2. 🔗 链接挂了能自动修 (Self-Healing) 🔥
这可能是最有用的功能。
很多时候收藏的 GitHub 库改名了，或者作者删库了，链接就变 404。
这个工具发现 404 后，**不会直接报错摆烂**，而是：
1.  先重试几次。
2.  如果不灵，它会去 DuckDuckGo **搜这个项目的名字**。
3.  如果找到了新的有效地址（比如项目改名迁移了），它会**自动把 Notion 里的链接改过来**，并给你发个通知。
4.  实在找不到，才会标记为 `Broken` 等你手动处理。

### 3. 📦 每天自动备份 + 一键复活
怕 Notion 挂了？或者账号出问题？
它每天会自动把 Notion 里的所有数据拉下来，存成：
*   JSON 文件（数据结构）
*   Markdown 文件（方便人看）
*   **`data_seed_latest.py` (最强功能)**：这是一个 Python 脚本。
    *   **怎么用？** 假如你换了个 Notion 账号，或者新建了个数据库，直接运行这个脚本：`python data_seed_latest.py`
    *   **结果**：它会把之前备份的所有数据，原封不动地“种”进新数据库里。

---

## �️ 怎么跑起来？

### 1. 准备工作
先复制一份配置文件：
```bash
cp .env.example .env
```
打开 `.env` 填几个参数：
*   `NOTION_TOKEN`: Notion 的机器人 Token。
*   `NOTION_DATABASE_ID`: 你的数据库 ID。
*   (可选) Telegram 相关的，填了就能收到通知，不填也能跑。

### 2. 启动 (推荐用 Docker)
省事点，直接用 Docker 跑，环境都配好了：

```bash
docker-compose up -d
```
搞定。它会在后台一直运行，每天检查一次。

### 3. 本地手动跑
如果你想自己调试，或者手动触发一次备份：

```bash
# 装依赖
pip install -r requirements.txt

# 跑起来
python agent_brain.py
```

---

## 📂 文件是干嘛的？

*   `agent_brain.py`: **大脑**。主程序，负责循环检查、修链接、发通知。
*   `agent_notion.py`: **工具人**。负责跟 Notion 官方接口打交道，存数据、取数据。
*   `backup_data.py`: **备份员**。专门负责把数据拉回本地存起来，顺便生成那个“复活脚本”。
*   `data_seed_latest.py`: **复活药**。这就是自动生成的那个脚本，可以直接运行恢复数据。

---

## 📝 常见问题

**Q: 怎么加新技能？**
A: 打开你的 Notion 数据库，点 New，填名字和 URL，选个 Tag (Skill/MCP)，完事。

**Q: 备份在哪？**
A: 项目目录下的 `backups/` 文件夹里。

**Q: 数据库被清空了怎么办？**
A: 运行 `python data_seed_latest.py`，喝杯咖啡，数据就回来了。

---

## License
MIT
